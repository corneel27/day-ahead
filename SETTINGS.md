# Day Ahead Optimizer - Configuration Settings

**Auto-generated from Pydantic models using JSON Schema**
**Configuration Version**: 0

> ⚠️ **Do not edit this file manually!**
> This documentation is auto-generated from Pydantic models.
> To update, modify the model docstrings and Field descriptions, then run:
> ```bash
> python -m dao.prog.config.generate_docs
> ```

## Optional vs Required Fields

| Default Value | Meaning |
|---------------|---------|
| `null` | Optional field, defaults to null/none (not set) |
| `"value"`, `123`, `true`, etc. | Optional field with this default value |
| `[]`, `{{}}` | Optional field, empty collection by default |
| _See nested fields_ | Uses defaults from nested model (cannot be set to `null`) |
| `—` | **Required** field - must be provided |

##  Day Ahead Optimizer Configuration

Configuration schema for the Day Ahead Optimizer Home Assistant add-on. This schema defines all available configuration options including battery settings, solar panels, pricing, scheduler, graphics, and more.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `config_version` | integer | No | `0` | Config Version |
| `homeassistant` | [HomeAssistantConfig](#homeassistantconfig) | No | _See nested fields_ | Home Assistant connection settings |
| `database ha` | [HADatabaseConfig](#hadatabaseconfig) (optional) | No | `null` | Home Assistant database connection |
| `database da` | [DatabaseConfig](#databaseconfig) (optional) | No | `null` | Day Ahead optimization database connection |
| `latitude` | number (optional) | No | `null` | Latitude (auto-fetched from HA if not set) |
| `longitude` | number (optional) | No | `null` | Longitude (auto-fetched from HA if not set) |
| `time_zone` | string (optional) | No | `null` | Timezone (auto-fetched from HA if not set) |
| `country` | string (optional) | No | `null` | Country code (auto-fetched from HA if not set) |
| `meteoserver-key` | string or [SecretStr](#secretstr) | Yes | — | Meteoserver API key (can use !secret) |
| `meteoserver-model` | string | No | `"harmonie"` | Meteoserver model. Options: `harmonie`, `gfs` |
| `meteoserver-attemps` | integer (optional) | No | `2` | Number of meteoserver fetch attempts |
| `prices` | [PricingConfig](#pricingconfig) (optional) | No | `null` | Day-ahead pricing and tariff configuration |
| `logging level` | string | No | `"info"` | Logging level. Options: `debug`, `info`, `warning`, `error` |
| `protocol api` | string (optional) | No | `null` | API protocol |
| `use_calc_baseload` | boolean or string | No | `"false"` | Whether to calculate baseload automatically |
| `baseload calc periode` | integer | No | `56` | Period in days for baseload calculation |
| `baseload` | number or list[number] (optional) | No | `null` | Baseload power consumption (watts) - single value or 24 hourly values |
| `graphical backend` | string | No | `""` | Matplotlib graphical backend |
| `graphics` | [GraphicsConfig](#graphicsconfig) | No | _See nested fields_ | Graphics and visualization settings |
| `interval` | integer or string (optional) | No | `null` | Optimization interval in minutes |
| `strategy` | string | No | `"minimize cost"` | Optimization strategy. Options: `minimize cost`, `minimize consumption` |
| `notifications` | [NotificationsConfig](#notificationsconfig) (optional) | No | `null` | Notification settings |
| `grid` | [GridConfig](#gridconfig) | No | _See nested fields_ | Grid connection settings |
| `history` | [HistoryConfig](#historyconfig) | No | _See nested fields_ | History retention settings |
| `dashboard` | [DashboardConfig](#dashboardconfig) | No | _See nested fields_ | Dashboard web UI settings |
| `battery` | list[[BatteryConfig](#batteryconfig)] | No | `null` | Battery configurations |
| `solar` | list[[SolarConfig](#solarconfig)] | No | `null` | Solar panel configurations |
| `electric vehicle` | list[[EVConfig](#evconfig)] | No | `null` | Electric vehicle configurations |
| `machines` | list[[MachineConfig](#machineconfig)] | No | `null` | Appliance/machine configurations |
| `boiler` | [BoilerConfig](#boilerconfig) (optional) | No | `null` | Hot water boiler configuration |
| `heating` | [HeatingConfig](#heatingconfig) (optional) | No | `null` | Heating system / heat pump configuration |
| `tibber` | [TibberConfig](#tibberconfig) (optional) | No | `null` | Tibber API integration |
| `report` | [ReportConfig](#reportconfig) | No | _See nested fields_ | Reporting entity configuration |
| `scheduler` | [SchedulerConfig](#schedulerconfig) | No | _See nested fields_ | Task scheduler configuration |

###  BatteryConfig

Battery configuration for optimization.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `name` | string | Yes | — | Battery name/identifier |
| `entity actual level` | string | Yes | — | HA entity for current battery SOC |
| `capacity` | number | Yes | — | Battery capacity in kWh |
| `upper limit` | integer or [FlexValue](#flexvalue) | Yes | — | Maximum SOC % (can be HA entity) |
| `lower limit` | integer or [FlexValue](#flexvalue) | Yes | — | Minimum SOC % (can be HA entity) |
| `optimal lower level` | integer or [FlexValue](#flexvalue) (optional) | No | `null` | Optimal lower SOC % for cost optimization |
| `entity min soc end opt` | string (optional) | No | `null` | HA entity for minimum SOC at end of optimization period |
| `entity max soc end opt` | string (optional) | No | `null` | HA entity for maximum SOC at end of optimization period |
| `charge stages` | list[[BatteryStage](#batterystage)] | Yes | — | Charge power/efficiency curve |
| `discharge stages` | list[[BatteryStage](#batterystage)] | Yes | — | Discharge power/efficiency curve |
| `reduced hours` | object (optional) | No | `null` | Hour -> max power mapping for reduced power hours |
| `minimum power` | integer | Yes | — | Minimum power in watts |
| `dc_to_bat efficiency` | number | Yes | — | DC to battery efficiency |
| `dc_to_bat max power` | number | Yes | — | DC to battery max power in watts |
| `bat_to_dc efficiency` | number | Yes | — | Battery to DC efficiency |
| `bat_to_dc max power` | number | Yes | — | Battery to DC max power in watts |
| `cycle cost` | number | Yes | — | Cost per battery cycle in euros |
| `entity set power feedin` | string (optional) | No | `null` | HA entity to set power feed-in to grid |
| `entity set operating mode` | string (optional) | No | `null` | HA entity to set battery operating mode |
| `entity set operating mode on` | string (optional) | No | `null` | Value for operating mode ON |
| `entity set operating mode off` | string (optional) | No | `null` | Value for operating mode OFF |
| `entity stop inverter` | string (optional) | No | `null` | HA entity to stop inverter |
| `entity balance switch` | string (optional) | No | `null` | HA entity for grid balancing switch |
| `entity from battery` | string (optional) | No | `null` | HA entity for power from battery |
| `entity from pv` | string (optional) | No | `null` | HA entity for power from PV |
| `entity from ac` | string (optional) | No | `null` | HA entity for power from AC |
| `entity calculated soc` | string (optional) | No | `null` | HA entity for calculated SOC |
| `solar` | list[[SolarConfig](#solarconfig)] (optional) | No | `null` | DC-coupled solar panels attached to this battery |

###  BatteryStage

Single charge/discharge stage with power and efficiency.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `power` | number | Yes | — | Power level in Watts |
| `efficiency` | number | Yes | — | Efficiency at this power level (0-1) |

###  BoilerConfig

Hot water boiler configuration.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `boiler present` | boolean or string | No | `true` | Whether boiler is present/enabled |
| `entity actual temp.` | string | Yes | — | HA entity for actual water temperature |
| `entity setpoint` | string | Yes | — | HA entity for temperature setpoint |
| `entity hysterese` | string | Yes | — | HA entity for temperature hysteresis |
| `entity boiler enabled` | string (optional) | No | `null` | HA entity for boiler enabled status |
| `entity instant start` | string (optional) | No | `null` | HA entity for instant start |
| `cop` | number | No | `3.0` | Coefficient of Performance |
| `cooling rate` | number | Yes | — | Cooling rate in degrees per hour |
| `volume` | number | No | `200.0` | Water volume in liters |
| `heating allowed below` | number | Yes | — | Temperature below which heating is allowed |
| `elec. power` | number | No | `1000.0` | Electrical power in watts |
| `activate service` | string | Yes | — | Service type to activate boiler (e.g., 'press', 'switch') |
| `activate entity` | string | Yes | — | HA entity to activate boiler |

###  DashboardConfig

Dashboard web UI configuration.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `port` | integer | No | `5000` | Web UI port number |

###  DatabaseConfig

Day Ahead database configuration (database da).

Can be either SQLite, MySQL/MariaDB, or PostgreSQL.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `engine` | string | No | `"sqlite"` | Database engine type. Options: `sqlite`, `mysql`, `postgresql` |
| `db_path` | string (optional) | No | `null` | Database path for SQLite (e.g., '../data') |
| `database` | string (optional) | No | `null` | Database filename for SQLite or database name for MySQL |
| `server` | string (optional) | No | `null` | MySQL server hostname (required for mysql) |
| `port` | integer (optional) | No | `null` | MySQL/PostgreSQL server port (required for mysql/postgresql) |
| `username` | string (optional) | No | `null` | MySQL username (required for mysql) |
| `password` | string or [SecretStr](#secretstr) (optional) | No | `null` | MySQL password (can use !secret) |
| `time_zone` | string (optional) | No | `null` | Database timezone |

###  EVChargeScheduler

EV charge scheduling configuration.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `entity set level` | string | Yes | — | HA entity to set target charge level |
| `level margin` | integer | Yes | — | Margin in % for charge level completion |
| `entity ready datetime` | string | Yes | — | HA entity for ready datetime (when charging should complete) |

###  EVChargeStage

Single EV charging stage with amperage and efficiency.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `ampere` | integer | Yes | — | Charging current in amperes |
| `efficiency` | number | Yes | — | Charging efficiency at this amperage (0-1) |

###  EVConfig

Electric Vehicle configuration.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `name` | string | Yes | — | EV name/identifier |
| `capacity` | number | Yes | — | Battery capacity in kWh |
| `entity position` | string | Yes | — | HA device tracker for vehicle position |
| `charge three phase` | boolean or string | No | `true` | Whether vehicle charges on three phases |
| `charge stages` | list[[EVChargeStage](#evchargestage)] | Yes | — | Charging amperage/efficiency curve |
| `entity actual level` | string | Yes | — | HA entity for current battery level % |
| `entity plugged in` | string | Yes | — | HA binary sensor for plugged in status |
| `entity instant start` | string (optional) | No | `null` | HA entity for instant start charging |
| `entity instant level` | string (optional) | No | `null` | HA entity for instant charge level target |
| `charge scheduler` | [EVChargeScheduler](#evchargescheduler) (optional) | No | `null` | Charge scheduling configuration |
| `charge switch` | string | Yes | — | HA switch entity to control charging |
| `entity set charging ampere` | string | Yes | — | HA entity to set charging amperage |
| `entity stop charging` | string | Yes | — | HA entity for stop charging datetime |

###  FlexValue

A flexible value that can be either a literal or a Home Assistant entity ID.

Supports all HA entity types: int, float, str, bool

Examples:
    FlexValue(value=95)                    # Literal integer
    FlexValue(value="sensor.battery_soc")  # HA entity ID
    FlexValue(value=True)                  # Literal boolean
    FlexValue(value="binary_sensor.grid")  # HA entity ID

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `value` | integer or number or string or boolean | Yes | — | Value |
| `is_entity` | boolean | No | `false` | True if value is a HA entity ID |

###  GraphicsConfig

Graphics and visualization settings.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `style` | string | No | `"dark_background"` | Matplotlib style (e.g., 'dark_background', 'default') |
| `show` | boolean or string | No | `"false"` | Whether to show graphics |
| `battery balance` | boolean or string | No | `"true"` | Show battery balance in graphs |
| `prices consumption` | boolean or string | No | `"true"` | Show consumption prices in graphs |
| `prices production` | boolean or string | No | `"false"` | Show production prices in graphs |
| `prices spot` | boolean or string | No | `"true"` | Show spot prices in graphs |
| `average consumption` | boolean or string | No | `"true"` | Show average consumption in graphs |

###  GridConfig

Electrical grid connection configuration.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `max_power` | number | No | `17` | Maximum grid power in kW |

###  HADatabaseConfig

Home Assistant database connection configuration.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `engine` | string | No | `"mysql"` | Database engine type. Options: `mysql`, `sqlite`, `postgresql` |
| `server` | string (optional) | No | `null` | Database server hostname (required for mysql/postgresql) |
| `port` | integer (optional) | No | `null` | Database port |
| `database` | string | No | `"homeassistant"` | Database name |
| `username` | string | No | `"homeassistant"` | Database username |
| `password` | string or [SecretStr](#secretstr) (optional) | No | `null` | Database password (can use !secret) |

###  HeatingConfig

Heating system / heat pump configuration.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `heater present` | boolean or string | No | `false` | Whether heating system is present/enabled |
| `entity hp enabled` | string (optional) | No | `null` | HA binary sensor for heat pump enabled status |
| `degree days factor` | number | No | `1.0` | Degree days factor for heat demand calculation |
| `adjustment` | string | No | `"power"` | Adjustment mode. Options: `on/off`, `power`, `heating curve` |
| `stages` | list[[HeatingStage](#heatingstage)] | Yes | — | Heating power/COP stages |
| `entity adjust heating curve` | string (optional) | No | `null` | HA entity to adjust heating curve |
| `adjustment factor` | number (optional) | No | `null` | Factor for heating curve adjustment |
| `min run length` | integer | No | `1` | Minimum run length in time intervals |
| `entity hp heat produced` | string (optional) | No | `null` | HA entity for heat produced |
| `entity hp heat demand` | string (optional) | No | `null` | HA entity for heat demand |
| `entity avg temp` | string (optional) | No | `null` | HA entity for average temperature |
| `entity hp cop` | string (optional) | No | `null` | HA entity for heat pump COP |
| `entity hp power` | string (optional) | No | `null` | HA entity for heat pump power |
| `entity hp switch` | string (optional) | No | `null` | HA entity to control heat pump on/off |

###  HeatingStage

Single heating stage with power and COP.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `max_power` | number | Yes | — | Maximum power in watts for this stage |
| `cop` | number | Yes | — | Coefficient of Performance at this power level |

###  HistoryConfig

History and data retention settings.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `save days` | integer | No | `7` | Number of days to retain historical data |

###  HomeAssistantConfig

Home Assistant connection configuration.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `host` | string (optional) | No | `null` | Home Assistant IP address (auto-detected if not set) |
| `ip port` | integer (optional) | No | `null` | Home Assistant port (default: 8123) |
| `token` | string or [SecretStr](#secretstr) (optional) | No | `null` | Home Assistant long-lived access token (can use !secret) |
| `protocol api` | string (optional) | No | `null` | API protocol |

###  MachineConfig

Appliance/machine configuration (washing machine, dishwasher, etc.).

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `name` | string | Yes | — | Machine name/identifier |
| `programs` | list[[MachineProgram](#machineprogram)] | Yes | — | Available programs with power profiles |
| `entity start window` | string | Yes | — | HA entity for start window datetime |
| `entity end window` | string | Yes | — | HA entity for end window datetime |
| `entity selected program` | string | Yes | — | HA entity for selected program |
| `entity calculated start` | string | Yes | — | HA entity for calculated optimal start time |
| `entity calculated end` | string | Yes | — | HA entity for calculated end time |
| `entity instant start` | string (optional) | No | `null` | HA entity for instant start |

###  MachineProgram

Single machine program with power profile.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `name` | string | Yes | — | Program name (e.g., 'eco', 'quick wash', 'off') |
| `power` | list[number] | Yes | — | Power consumption in watts for each time interval |

###  NotificationsConfig

Notification settings for Home Assistant.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `notification entity` | string (optional) | No | `null` | HA entity for notifications |
| `opstarten` | boolean or string | No | `"false"` | Send notification on startup |
| `berekening` | boolean or string | No | `"false"` | Send notification on calculation completion |
| `last activity entity` | string (optional) | No | `null` | HA entity to track last activity timestamp |

###  PricingConfig

Day-ahead pricing and tariff configuration.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `source day ahead` | string | No | `"nordpool"` | Source for day-ahead prices. Options: `nordpool`, `entsoe`, `tibber` |
| `entsoe-api-key` | string or [SecretStr](#secretstr) (optional) | No | `null` | ENTSO-E API key (can use !secret) |
| `energy taxes consumption` | object | Yes | — | Energy taxes for consumption by date (YYYY-MM-DD -> euro/kWh ex VAT) |
| `energy taxes production` | object | Yes | — | Energy taxes for production by date (YYYY-MM-DD -> euro/kWh ex VAT) |
| `cost supplier consumption` | object | Yes | — | Supplier costs for consumption by date (YYYY-MM-DD -> euro/kWh ex VAT) |
| `cost supplier production` | object | Yes | — | Supplier costs for production by date (YYYY-MM-DD -> euro/kWh ex VAT) |
| `vat consumption` | object | Yes | — | VAT percentage for consumption by date (YYYY-MM-DD -> %) |
| `vat production` | object | Yes | — | VAT percentage for production by date (YYYY-MM-DD -> %) |
| `last invoice` | string | Yes | — | Date of last invoice (YYYY-MM-DD) |
| `tax refund` | boolean or string | Yes | — | Whether tax refund applies |

###  ReportConfig

Reporting and sensor entity configuration.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `entities grid consumption` | list[string] | No | `null` | HA entities for grid consumption |
| `entities grid production` | list[string] | No | `null` | HA entities for grid production |
| `entities solar production ac` | list[string] | No | `null` | HA entities for AC solar production |
| `entities solar production dc` | list[string] | No | `null` | HA entities for DC solar production |
| `entities ev consumption` | list[string] | No | `null` | HA entities for EV consumption |
| `entities wp consumption` | list[string] | No | `null` | HA entities for heat pump (warmtepomp) consumption |
| `entities boiler consumption` | list[string] | No | `null` | HA entities for boiler consumption |
| `entities battery consumption` | list[string] | No | `null` | HA entities for battery consumption |
| `entities battery production` | list[string] | No | `null` | HA entities for battery production |
| `entities machine consumption` | list[string] | No | `null` | HA entities for machine consumption |
| `co2 intensity sensor` | string (optional) | No | `null` | HA entity for CO2 intensity |
| `sensors` | object (optional) | No | `null` | Additional sensors configuration |

###  SchedulerConfig

Task scheduler configuration.

Maps time patterns to action names.
Time patterns can be:
- Specific times: "0435", "1255"
- Wildcards: "xx00" (every hour at :00), "xx15" (every hour at :15)

Actions include:
- get_meteo_data
- get_tibber_data
- get_day_ahead_prices
- calc_optimum
- clean_data
- calc_baseloads

*No configuration fields.*

###  SecretStr

A secret string reference that gets resolved from secrets.json.

Example in options.json:
    {"db_password": "!secret db_password"}
    
Gets resolved to actual value from secrets.json:
    {"db_password": "my_actual_password_123"}

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `secret_key` | string | Yes | — | Secret Key |

###  SolarConfig

Solar panel configuration.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `name` | string | Yes | — | Solar installation name/identifier |
| `entity pv switch` | string (optional) | No | `null` | HA entity to enable/disable this solar installation |
| `tilt` | number (optional) | No | `null` | Panel tilt (for single installation) |
| `orientation` | number (optional) | No | `null` | Panel orientation (for single installation) |
| `capacity` | number (optional) | No | `null` | Installed capacity (for single installation) |
| `yield` | number (optional) | No | `null` | Yield factor (for single installation) |
| `strings` | list[[SolarString](#solarstring)] (optional) | No | `null` | Multiple panel strings with different configurations |

###  SolarString

Configuration for a single solar panel string.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `tilt` | number | Yes | — | Panel tilt angle in degrees (0=horizontal, 90=vertical) |
| `orientation` | number | Yes | — | Panel orientation in degrees (0=south, 90=west, -90=east) |
| `capacity` | number | Yes | — | Installed capacity in kWp |
| `yield` | number | Yes | — | Yield factor for production calculation |

###  TibberConfig

Tibber API integration configuration.

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| `api_token` | string or [SecretStr](#secretstr) | Yes | — | Tibber API token (can use !secret) |
| `api url` | string (optional) | No | `"https://api.tibber.com/v1-beta/gql"` | Tibber API URL |
